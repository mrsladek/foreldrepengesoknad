import{j as i,a as g,F as B}from"./jsx-runtime-670450c2.js";import{i as f,a as N,w as R,B as S,d as m,g as D}from"./validationUtils-f899988d.js";import"./index-7e4e529b.js";import"./index-f1f749bf.js";import{r as A,I as u,a7 as U,n as M}from"./dateUtils-c998f5da.js";import{Q as I}from"./index-47edccfa.js";import{g as b}from"./getTypedFormComponents-b4bc17b3.js";import{B as v}from"./Link-40b5f3c6.js";import{o as x,l as z,p as K,q,r as P,k as y}from"./useSøknad-ada7a5d2.js";import{j as w}from"./personUtils-75f6963a.js";var T=(e=>(e.harForståttRettigheterOgPlikter="harForståttRettigheterOgPlikter",e.valgteBarn="valgteBarn",e))(T||{});const he=e=>({harForståttRettigheterOgPlikter:e,valgteBarn:void 0}),G={valgteBarn:{isIncluded:({selectableBarn:e})=>e.length>0,isAnswered:({valgteBarn:e})=>e!==void 0,visibilityFilter:({selectableBarn:e})=>e.length>0},harForståttRettigheterOgPlikter:{isAnswered:({harForståttRettigheterOgPlikter:e})=>e===!0,isIncluded:({valgteBarn:e,selectableBarn:t})=>e!==void 0||t.length===0}},Y=b(),Fe=I(G),Be=e=>t=>{if(t!==!0)return f(e,"valideringsfeil.velkommen.harForståttRettigheterOgPlikter.påkrevd")},C=e=>t=>{if(t===void 0)return f(e,"steg.footer.spørsmålMåBesvares")};const Q=({sakErFerdigbehandlet:e})=>{const t=N();return i(R,{className:"blokk-xxxs",variant:e?"success":"warning",children:g(v,{size:"small",children:[f(t,e?"velkommen.sak.status.ferdigBehandlet":"velkommen.sak.status.underBehandling")," "]})})};try{SknadStatus.displayName="SknadStatus",SknadStatus.__docgenInfo={description:"",displayName:"SknadStatus",props:{sakErFerdigbehandlet:{defaultValue:null,description:"",name:"sakErFerdigbehandlet",required:!0,type:{name:"boolean"}}}}}catch{}var k=(e=>(e.FØDT="født",e.UFØDT="ufødt",e.ADOPTERT="adoptert",e.IKKE_UTFYLT="ikkeUtfylt",e))(k||{}),H=(e=>(e.SØKNAD_GJELDER_NYTT_BARN="søknad_gjeder_nytt_barn",e))(H||{});const J=e=>({label:g(B,{children:[i(v,{className:"radioTittle",size:"medium",children:f(e,"omBarnet.gjelderAnnetBarn")}),i(S,{margin:"l",children:g(v,{size:"small",children:[" ",f(e,"velkommen.intro.harSaker.barnVelger.info")]})})]}),value:"søknad_gjeder_nytt_barn",className:"radioGroupButton"}),j=e=>i(S,{className:"radioDescription",margin:"l",children:i(Q,{sakErFerdigbehandlet:e})}),W=(e,t,a)=>{const r=K(e,a);return f(a,"velkommen.barnVelger.ufødtBarn",{antallBarnTekst:r,termin:A(t)})},X=(e,t)=>{const a=W(e.antallBarn,e.termindato,t),r=e.sak!==void 0?j(e.sak.åpenBehandling===void 0):void 0,d=e.sak!==void 0?f(t,"velkommen.barnVelger.saksnummer",{saksnummer:e.sak.saksnummer}):"",s=e.sak!==void 0;return{label:g(B,{children:[i(v,{className:"radioTittle",size:"medium",children:a}),s&&g(B,{children:[i(v,{size:"small",className:"radioDescription",children:d}),r]})]}),value:e.id,className:"radioGroupButton"}},Z=(e,t)=>{const a=x(e.fornavn,e.fødselsdatoer,e.omsorgsovertagelse,e.alleBarnaLever,e.antallBarn,t),r=z(e.fødselsdatoer),d=e.type==="født"||e.type==="ikkeUtfylt"?r:A(e.omsorgsovertagelse),s=e.type==="født"||e.type==="ikkeUtfylt"?f(t,"velkommen.barnVelger.født"):f(t,"velkommen.barnVelger.adopsjon"),o=e.sak!==void 0?f(t,"velkommen.barnVelger.saksnummer",{saksnummer:e.sak.saksnummer}):"",p=e.sak!==void 0?j(e.sak.åpenBehandling===void 0):void 0;return{label:g(B,{children:[i(v,{size:"medium",className:"radioTittle",children:a}),e.alleBarnaLever&&g(v,{size:"small",className:"radioDescription",children:[s," ",d]}),i(v,{size:"small",children:o}),p!==void 0&&p]}),value:e.id,name:T.valgteBarn,className:"radioGroupButton"}},$=(e,t)=>{switch(e.type){case"født":case"adoptert":case"ikkeUtfylt":return Z(e,t);case"ufødt":return X(e,t);default:return}},_=e=>{const t=N();return i(S,{visible:e.visibility.isVisible(T.valgteBarn),children:i(S,{margin:"xl",children:i(Y.RadioGroup,{legend:f(t,"velkommen.intro.harSaker.barnVelger.label"),name:T.valgteBarn,validate:C(t),radios:e.selectableBarn.map(a=>$(a,t)).concat([J(t)])})})})};try{_.displayName="BarnVelger",_.__docgenInfo={description:"",displayName:"BarnVelger",props:{selectableBarn:{defaultValue:null,description:"",name:"selectableBarn",required:!0,type:{name:"SelectableBarn[]"}},visibility:{defaultValue:null,description:"",name:"visibility",required:!0,type:{name:"QuestionVisibility<VelkommenFormField, any>"}},formValues:{defaultValue:null,description:"",name:"formValues",required:!0,type:{name:"VelkommenFormData"}},setFieldValue:{defaultValue:null,description:"",name:"setFieldValue",required:!0,type:{name:"(field: string, value: any, shouldValidate?: boolean | undefined) => void"}}}}}catch{}const ee=(e,t)=>e?k.ADOPTERT:t.fødselsdato!==void 0?k.FØDT:k.UFØDT,O=(e,t)=>e===void 0||t===void 0?!1:m(e).isSameOrAfter(m(t).subtract(1,"day"),"day")&&m(e).isSameOrBefore(m(t).add(1,"day"),"day"),te=(e,t)=>{const a=e.barn!==void 0?e.barn.map(l=>l.fnr).flat():[],r=u(e.familiehendelse.fødselsdato),d=t.filter(l=>a.includes(l.fnr)),s=r!==void 0?t.filter(l=>O(l.fødselsdato,r)&&!d.find(V=>V.fnr===l.fnr)):[],o=d.concat(s),p=u(U(e.familiehendelse.termindato,e.familiehendelse.fødselsdato,e.familiehendelse.omsorgsovertakelse)),h=ee(e.gjelderAdopsjon,e.familiehendelse);return{id:D(),type:h,antallBarn:e.familiehendelse.antallBarn,termindato:u(e.familiehendelse.termindato),omsorgsovertagelse:u(e.familiehendelse.omsorgsovertakelse),kanSøkeOmEndring:e.kanSøkeOmEndring,sak:e,fødselsdatoer:r!==void 0?Array(e.familiehendelse.antallBarn).fill(r):void 0,familiehendelsesdato:p,sortableDato:u(e.familiehendelse.termindato),startdatoFørsteStønadsperiode:e.gjeldendeVedtak!==void 0&&e.gjeldendeVedtak.perioder.length>0?M(u(e.gjeldendeVedtak.perioder[0].fom)).denneEllerNeste():void 0,fornavn:o!==void 0&&o.length>0?o.filter(l=>l.fornavn!==void 0&&l.fornavn.trim()!=="").map(l=>[l.fornavn,l.mellomnavn!==void 0?l.mellomnavn:""].join(" ")):void 0,fnr:o!==void 0&&o.length>0?o.filter(l=>l.fnr!==void 0).map(l=>l.fnr):void 0,alleBarnaLever:o!==void 0&&o.length>0?o.every(l=>y(l)):!1}},ne=(e,t)=>{const a=e.mellomnavn!==void 0?[e.fornavn,e.mellomnavn].join(" "):e.fornavn;return{id:D(),type:k.IKKE_UTFYLT,antallBarn:1,fødselsdatoer:[e.fødselsdato],fornavn:a!==void 0?[a]:void 0,fnr:[e.fnr],sortableDato:e.fødselsdato,alleBarnaLever:y(e),annenForelder:t}},ae=(e,t,a)=>{const r=[e].concat(t).sort(oe);if(!(r.find(s=>!y(s)&&P(s))||r.length==0))return{id:D(),type:k.IKKE_UTFYLT,antallBarn:r.length,fødselsdatoer:r.map(s=>s.fødselsdato),fornavn:r.map(s=>[s.fornavn,s.mellomnavn!==void 0?s.mellomnavn:""].join(" ")),fnr:r.map(s=>s.fnr),sortableDato:r[0].fødselsdato,alleBarnaLever:r.every(s=>y(s)),annenForelder:a}},re=(e,t)=>e.filter(a=>a.barn!==void 0&&a.barn.length>0||a.familiehendelse.termindato!==void 0||a.familiehendelse.fødselsdato!==void 0||a.familiehendelse.omsorgsovertakelse!==void 0).map(a=>te(a,t)),se=(e,t,a)=>{const r=e.filter(n=>!a.find(c=>O(n.fødselsdato,u(c.familiehendelse.fødselsdato)))),d="tempFnr",s=r.map(n=>n.fnr===void 0?{...n,fnr:d+D().toString()}:n),o=t.map(n=>n.fnr).flat(),p=t.filter(n=>n.fødselsdatoer!==void 0&&n.fødselsdatoer.length>0).map(n=>n.fødselsdatoer).flat(),h=[];return s.filter(n=>!(n.dødsdato!==void 0&&p.find(c=>m(c).isSame(m(n.fødselsdato),"day")))).forEach(n=>{if(!o.includes(n.fnr)&&!w(n.fødselsdato)){const c=q(n.fnr,n.fødselsdato,s),E=n.annenForelder!==void 0?{fnr:n.annenForelder.fnr,fornavn:n.annenForelder.fornavn,mellomnavn:n.annenForelder.mellomnavn,etternavn:n.annenForelder.etternavn}:void 0;if(o.push(n.fnr),c.length===0){if(!P(n)){const F=ne(n,E);h.push(F)}}else{const F=ae(n,c,E);c.forEach(L=>{o.push(L.fnr)}),F!==void 0&&h.push(F)}}}),h.map(n=>n.fnr&&n.fnr.length>0?{...n,fnr:n.fnr.filter(c=>c&&!c.startsWith(d))}:n)},Se=(e,t)=>{const a=e.filter(o=>!o.sakAvsluttet),r=e.filter(o=>o.sakAvsluttet),d=re(a,t),s=se(t,d,r);return d.concat(s)},ye=(e,t)=>{var d,s;const a=t.filter(o=>o.sak!==void 0&&o.id!==e.id&&o.familiehendelsesdato!==void 0&&m(o.familiehendelsesdato).isAfter(e.familiehendelsesdato,"day"));a.sort(le);const r=a[a.length-1];if(r!==void 0)return{familiehendelsesdato:r.familiehendelsesdato,startdatoFørsteStønadsperiode:r.startdatoFørsteStønadsperiode,fnr:r.fnr,annenForelderFnr:(s=(d=r.sak)==null?void 0:d.annenPart)==null?void 0:s.fnr}};function oe(e,t){return m(e.fødselsdato).isAfter(t.fødselsdato,"d")?1:m(e.fødselsdato).isBefore(t.fødselsdato,"d")||e.fornavn<t.fornavn?-1:1}function le(e,t){return m(e.sortableDato).isBefore(t.sortableDato,"d")?1:m(e.sortableDato).isAfter(t.sortableDato,"d")?-1:0}export{_ as B,H as S,Y as V,he as a,T as b,Be as c,ye as d,oe as e,O as f,Se as g,le as s,Fe as v};
//# sourceMappingURL=velkommenUtils-27d89f17.js.map
